{"entries":[{"timestamp":1739691622192,"editorVersion":"7.0.57","changes":[{"type":"edited","filename":"main.blocks","patch":[{"diffs":[[0,"http"],[-1,"s"],[0,"://"],[-1,"developers.google.com/blockly/xml\"><variables></variables>"],[1,"www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n"],[0,"</xm"]],"start1":12,"start2":12,"length1":70,"length2":113}]},{"type":"edited","filename":"main.ts","patch":[{"diffs":[[-1,"// 定义MP3模块的命名空间\nnamespace mp3Player {\n    // 内部变量声明\n    let DATA_PIN: DigitalPin = DigitalPin.P0;\n    const CMD_DELAY = 5000; // 命令间延时\n\n    // 指令编码枚举\n    enum ControlCommand {\n        Play = 0x01,\n        Pause = 0x02,\n        Stop = 0x04,\n        Previous = 0x05,\n        Next = 0x06,\n        Reset = 0x07\n    }\n\n    // 播放模式枚举\n    enum PlayMode {\n        Loop = 0x08,\n        Random = 0x09\n    }\n\n    //% block=\"设置引脚 $pin\"\n    //% pin.defl=DigitalPin.P0\n    export function setPin(pin: DigitalPin): void {\n        DATA_PIN = pin;\n        pins.digitalWritePin(DATA_PIN, 1); // 初始化拉高\n    }\n\n    // 生成指令数据包\n    function createCommand(cmd: number, dataH: number, dataL: number): number {\n        return ((cmd << 12) | (dataH << 8) | dataL) & 0xFFFF;\n    }\n\n    // 发送单字节数据\n    function sendByte(dat: number): void {\n        // 发送起始信号\n        pins.digitalWritePin(DATA_PIN, 0);\n        control.waitMicros(5000);\n\n        // 发送16位数据\n        for (let i = 0; i < 16; i++) {\n            if (dat & 0x8000) { // 发送1\n                pins.digitalWritePin(DATA_PIN, 1);\n                control.waitMicros(600);\n                pins.digitalWritePin(DATA_PIN, 0);\n                control.waitMicros(200);\n            } else { // 发送0\n                pins.digitalWritePin(DATA_PIN, 1);\n                control.waitMicros(200);\n                pins.digitalWritePin(DATA_PIN, 0);\n                control.waitMicros(600);\n            }\n            dat <<= 1;\n        }\n\n        // 恢复高电平\n        pins.digitalWritePin(DATA_PIN, 1);\n        control.waitMicros(CMD_DELAY);\n    }\n\n    //% block=\"控制命令 $cmd\"\n    //% cmd.defl=ControlCommand.Play\n    export function sendCommand(cmd: ControlCommand): void {\n        const command = createCommand(0x0F, cmd, 0x00);\n        sendByte(command);\n    }\n\n    //% block=\"设置音量 %volume\"\n    //% volume.min=0 volume.max=10\n    export function setVolume(volume: number): void {\n        const command = createCommand(0x06, 0x00, Math.clamp(0, 10, volume));\n        sendByte(command);\n    }\n\n    //% block=\"播放第 %num 首\"\n    //% num.min=1 num.max=1023\n    export function playTrack(num: number): void {\n        num = Math.clamp(1, 1023, num);\n        const command = createCommand(0x03, (num >> 8) & 0xFF, num & 0xFF);\n        sendByte(command);\n    }\n\n    //% block=\"循环播放第 %num 首\"\n    //% num.min=1 num.max=1023\n    export function loopTrack(num: number): void {\n        num = Math.clamp(1, 1023, num);\n        const command = createCommand(0x04, (num >> 8) & 0xFF, num & 0xFF);\n        sendByte(command);\n    }\n\n    //% block=\"设置播放模式 %mode\"\n    export function setPlayMode(mode: PlayMode): void {\n        const command = createCommand(0x0F, mode, 0x00);\n        sendByte(command);\n    }\n}"],[1,"\n"]],"start1":0,"start2":0,"length1":2695,"length2":1}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0,"   \""],[-1,"testFiles\": [\n        \"test.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\""],[1,"additionalFilePaths\": []"],[0,"\n}\n"]],"start1":227,"start2":227,"length1":76,"length2":31}]},{"type":"added","filename":"test.ts","value":"// 在此处测试；当此软件包作为插件使用时，将不会编译此软件包。\n"}]}],"snapshots":[{"timestamp":1739691622191,"editorVersion":"7.0.57","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"MP3\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1739691758129}